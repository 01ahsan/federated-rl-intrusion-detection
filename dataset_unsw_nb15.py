# -*- coding: utf-8 -*-
"""Dataset-UNSW.NB15.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1axHSAVLwuPvqKlCaEwfToo3qDLngPj3W
"""

import pandas as pd
from sklearn.preprocessing import LabelEncoder, StandardScaler
import zipfile
import requests
import io

url = "https://research.unsw.edu.au/sites/default/files/uploaded-documents/UNSW-NB15%20dataset.zip"
r = requests.get(url)
z = zipfile.ZipFile(io.BytesIO(r.content))
z.extractall("unsw_data")

df = pd.read_csv("unsw_data/UNSW-NB15_1.csv")

df = df.dropna()
df = df.select_dtypes(include=['number', 'object'])

label_encoder = LabelEncoder()
df['label'] = label_encoder.fit_transform(df['label'])

X = df.drop("label", axis=1)
X = pd.get_dummies(X)
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

df_scaled = pd.DataFrame(X_scaled, columns=X.columns)
df_scaled["label"] = df["label"]

df_scaled.to_csv("UNSW_NB15_cleaned.csv", index=False)
print("Saved as UNSW_NB15_cleaned.csv")